<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>Parallax Scroll Demo - moutain view</title>
	<script type="text/javascript" src="js/zepto.min.js"></script>
	<script type="text/javascript" src="js/ParallaxScroll.js"></script>
	<style>
	body{
		margin: 0;
		padding: 0;
		font-family: arial;
	}
	a{text-decoration: none;}
	</style>
</head>
<body>

<h1 style="text-align: center;">Parallax Scroll Demo - moutain view</h1>

<div id="draw" style="position: relative; margin: 50px auto; width: 640px; height: 240px;
	overflow: hidden; background: #eee;">
</div>

<p style="text-align: center;">images stolen from <a href="http://stephband.info/jparallax/">http://stephband.info/jparallax/</a></p>


<script type="text/javascript">
var layers = [
	{
		//height: 288,
		width: 920,
		"children": [
			{
				"img": "1_mountains.png"
			},
			{
				y: 300
			}
		]
	},
	{
		//height: 288,
		width: 1100,
		y: 50,
		"children": [
			{
				"img": "2_hill.png"
			}
		]
	},
	{
		width: 1136,
		y: 80,
		"children": [
			{
				"img": "3_wood.png"
			}
		]
	}
];


for(var i in layers){
	var layer = layers[i];
	for(var j in layer.children){
		if(layer.children[j].img){
			layer.children[j].img = './imgs/stephband.info/' + layer.children[j].img;
		}
	}
}


var scroll = new ParallaxScroll('#draw');
scroll.load(layers);
//scroll.move(-scroll.max_width/2, 0);
console.log(scroll.scale, scroll.width, scroll.height, scroll.max_width);

$('#draw').on('mousemove', function(e){
	//return;
	var ox = e.clientX - $('#draw').offset().left;
	var oy = e.clientY - $('#draw').offset().top;
	var dx = ((-ox - scroll.x) / scroll.width) * (scroll.max_width - scroll.width);
	var dy = ((-oy - scroll.y) / scroll.height) * (scroll.max_height - scroll.height);
	//console.log(dx, dy);
	scroll.move(dx, dy);
});



function keyboard_handler(e){
	var c = String.fromCharCode(e.which);
	switch(c){
		case '&': //up
			scroll.move(0, +3);
			if(e.preventDefault) e.preventDefault();
			break;
		case '(': //down
			scroll.move(0, -3);
			if(e.preventDefault) e.preventDefault();
			break;
		case '%': // left
			scroll.move(-23, 0);
			if(e.preventDefault) e.preventDefault();
			break;
		case ' ':
		case '\'': // right
			scroll.move(+23, 0);
			if(e.preventDefault) e.preventDefault();
			break;
		default:
			break;
	}
}
$(document).bind('keydown', keyboard_handler);


</script>


</body>
</html>
